<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/font-awesome.css" />
	<link rel="stylesheet" type="text/css" href="css/style.css" />

	<script type="text/javascript">
	
		var app = {
			spreadsheet : {
				id : "0AmgH34NLQLU-dHA0QkViSnE2WV9tZGdXX2JRVC1ISEE",
				worksheets : {
					metadata : 0,
					constants : 19
				},
				dataTables : {}
			},
			inputs : {
				weather : ["month","tmin","tmax","tdmean","ppt","rad","daylight"]
			},
			outputs : ["VPD","fVPD","fT","fFrost","PAR","xPP","Intcptn","ASW","CumIrrig",
			           "Irrig","StandAge","LAI","CanCond","Transp","fSW","fAge",
			           "PhysMod","pR","pS","litterfall","NPP","WF","WR","WS","W"],
			debug : false,
			devmode : false
		};
	</script>
	
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/bootstrap-multiselect.js"></script>
	<script src="js/app.js"></script>
	<script src="js/gdrive.js"></script>
	<script src="js/inputForm.js"></script>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script src="https://apis.google.com/js/client.js"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
	
	
</head>
<body>

	<div id="status">Loading...</div>


	<script type="text/javascript">

		$("#status").html("Loading visualization package...");
		google.load('visualization', '1.0', {'packages':['corechart','table']});
		google.setOnLoadCallback(function(){
			$("#status").html("Loading 3pg model...");
			
			var version = qs("version");
			var devmode = qs("devmode");
			if( devmode ) app.devmode = true;
			
			app.loadModelCode(version, function(){
				$("#status").html("Loading 3pg data...");
				app.loadSpreadsheetData(function(){
					$("body").html("").load("app.html", function(){
						app.init(function(){
							app.gdrive.init(function(){
								var file = qs("file");
								if( file ) app.gdrive.load(file);
								
								// see if we are loading for google drive
								var state = qs("state");
								if( state ) {
									state = JSON.parse(state);
									app.gdrive.load(state.ids[0]);
								}
							});
						});
					});
				});
			});
		});
		
		// override the log function
		log = function(msg) {
			if( app.debug ) console.log(msg);
		};
	</script>
</body>
</html>
